(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{212:function(e,t,n){e.exports=n.p+"static/media/landing-background.0fb4ced4.jpg"},220:function(e,t,n){e.exports=n(410)},409:function(e,t,n){},410:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),u=n.n(c),i=n(29),o=n(110),l=n(65),s=(n(230),n(24)),f=n(149),d=n(85),m=n(25),p=n(151),v=n(152),g=n(197),h=n.n(g),E=(n(238),function(e){var t=e.center,n=e.coords;return r.a.createElement("div",{style:{height:"500px"}},r.a.createElement(p.a,{center:[t.lat,t.lon],zoom:12},r.a.createElement(h.a,{fitBoundsOnLoad:!0,fitBoundsOnUpdate:!0,points:n,latitudeExtractor:function(e){return e.lat},longitudeExtractor:function(e){return e.lon},intensityExtractor:function(e){return 3}}),r.a.createElement(v.a,{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})))}),b=function(e){var t=e.activities,n=[];return t.forEach(function(e){n=n.concat(e.coords)}),r.a.createElement(E,{center:n[0],coords:n})},O=n(411),w=n(26),j=n.n(w),y=n(34),x=n(414),D=n(42),I=n.n(D),k={deleteActivity:function(){var e=Object(y.a)(j.a.mark(function e(t){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.delete("".concat("/api/activities","/").concat(t));case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),Error(e.t0.response.data.error);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),upload:function(){var e=Object(y.a)(j.a.mark(function e(t){var n,a;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,t.forEach(function(e){n.append("file",e)}),e.prev=2,e.next=5,I.a.post("".concat("/api/activities","/upload"),n);case 5:return a=e.sent,e.abrupt("return",a.data);case 9:throw e.prev=9,e.t0=e.catch(2),Error(e.t0.response.data.error);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()},S=function(e){return{type:"SET_LOADING",data:e}},T=function(e){return{type:"INIT_ACTIVITIES",data:e}},A=function(e){return"".concat(e.getMonth()+1,"/").concat(e.getDate(),"/").concat(e.getFullYear())},U=function(e){return parseFloat(e.toFixed(2))},L=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=e%60;return[t,n>9?n:t?"0"+n:n||"0",a>9?a:"0"+a].filter(function(e){return e}).join(":")};function _(){var e=Object(s.a)(["\n  background-color: #ffffff;\n"]);return _=function(){return e},e}function C(){var e=Object(s.a)(["\n  color: #1890ff;\n  transition: 0.3s;\n  &:hover {\n    color: #40a9ff;\n    cursor: pointer;\n  }\n"]);return C=function(){return e},e}var M=m.a.div(C()),N=Object(m.a)(O.a)(_()),R=Object(i.b)(null,{deleteActivity:function(e){return function(){var t=Object(y.a)(j.a.mark(function t(n){return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(S(!0)),t.prev=1,t.next=4,k.deleteActivity(e);case 4:x.a.success("Delete successful"),n({type:"DELETE_ACTIVITY",data:e}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),x.a.error(t.t0.message);case 11:n(S(!1));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()}})(function(e){var t=e.activities,n=e.deleteActivity,a=[{title:"Name",dataIndex:"name"},{title:"Date",dataIndex:"date",defaultSortOrder:"ascend",sorter:function(e,t){return new Date(t.date)-new Date(e.date)}},{title:"Time",dataIndex:"time"},{title:"Distance",dataIndex:"distance"},{title:"Pace",dataIndex:"pace"},{title:"Action",render:function(e){return r.a.createElement(M,{onClick:function(){return n(e.id)}},"Delete")}}],c=t.map(function(e,t){return{key:t,id:e.id,name:e.name,date:A(new Date(e.date)),time:L(e.time),distance:"".concat(U(e.distance)," km"),pace:L(e.pace)}});return r.a.createElement(N,{columns:a,dataSource:c,pagination:!1})}),F=n(66),G=n(97),P=Object(i.b)(null,{uploadActivities:function(e){return function(){var t=Object(y.a)(j.a.mark(function t(n){var a;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n(S(!0)),t.prev=1,e&&e.length){t.next=4;break}throw Error("please select files before uploading");case 4:return t.next=6,k.upload(e);case 6:a=t.sent,x.a.success("Upload successful"),n({type:"NEW_ACTIVITIES",data:a}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),x.a.error(t.t0.message);case 14:n(S(!1));case 15:case"end":return t.stop()}},t,null,[[1,11]])}));return function(e){return t.apply(this,arguments)}}()}})(function(e){var t=Object(a.useState)(null),n=Object(G.a)(t,2),c=n[0],u=n[1];return r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.uploadActivities(c)}},r.a.createElement("input",{type:"file",multiple:!0,onChange:function(e){var t=e.target;return u(Array.from(t.files))}}),r.a.createElement(F.a,{type:"primary",htmlType:"submit"},"Upload"))}),V=function(){delete I.a.defaults.headers.common.Authorization},z=function(e){I.a.defaults.headers.common.Authorization="bearer ".concat(e)},Y=function(){var e=window.localStorage.getItem("dataRunnerLoggedInUser");return e?JSON.parse(e):null},B=function(){window.localStorage.removeItem("dataRunnerLoggedInUser")},J=function(e){window.localStorage.setItem("dataRunnerLoggedInUser",JSON.stringify(e))},W={login:function(){var e=Object(y.a)(j.a.mark(function e(t){var n;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.post("/api/login",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:throw e.prev=7,e.t0=e.catch(0),Error(e.t0.response.data.error);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(y.a)(j.a.mark(function e(t){var n;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.post("/api/register",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:throw e.prev=7,e.t0=e.catch(0),Error(e.t0.response.data.error);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()},H={getUserData:function(){var e=Object(y.a)(j.a.mark(function e(){var t;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.get("/api/user");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:throw e.prev=7,e.t0=e.catch(0),Error(e.t0.response.data.error);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},K=function(e){return{type:"SET_LOGGED_IN_USER",data:e}},q=function(e){return function(){var t=Object(y.a)(j.a.mark(function t(n){var a;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(S(!0)),n(K(e)),z(e.token),t.prev=3,t.next=6,H.getUserData();case 6:a=t.sent,n(T(a.activities)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),x.a.error(t.t0.message);case 13:n(S(!1));case 14:case"end":return t.stop()}},t,null,[[3,10]])}));return function(e){return t.apply(this,arguments)}}()},Q=function(e,t){return function(){var n=Object(y.a)(j.a.mark(function n(a){var r;return j.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a(S(!0)),n.prev=1,n.next=4,t?W.register(e):W.login(e);case 4:return r=n.sent,J(r),n.next=8,a(q(r));case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),x.a.error(n.t0.message);case 13:a(S(!1));case 14:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()};function X(){var e=Object(s.a)(["\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: space-between;\n  margin: 0 auto;\n  max-width: 60em;\n  min-height: 3.5em;\n"]);return X=function(){return e},e}function Z(){var e=Object(s.a)(["\n  background-color: #ffffff;\n  box-shadow: 0 1px 3px 0 rgba(0,0,0,0.2);\n  margin-bottom: 1em;\n  padding: 0.2em;\n  width: 100%;\n"]);return Z=function(){return e},e}var $=m.a.div(Z()),ee=m.a.div(X()),te=Object(i.b)(function(e){return{username:e.user.username}},{logoutUser:function(){return function(e){B(),V(),e(T(null)),e({type:"REMOVE_LOGGED_IN_USER",data:null})}}})(function(e){var t=e.username,n=e.logoutUser;return r.a.createElement($,null,r.a.createElement(ee,null,r.a.createElement(P,null),r.a.createElement("div",null,"Logged in as ",r.a.createElement("strong",null,t),"\xa0\xa0\xa0",r.a.createElement(F.a,{onClick:n},"Log out"))))}),ne=n(215),ae=n(209),re=n.n(ae),ce=function(e){var t=e.seriesData,n={dataLabels:{enabled:!1},plotOptions:{heatmap:{shadeIntensity:.5,colorScale:{ranges:[{from:-.01,to:.01,name:"No activities",color:"#CFD8DC"},{from:.01,to:e.highestDistance,name:"Activities",color:"#008FFB"}]}}}};return r.a.createElement(re.a,{options:n,series:t,type:"heatmap",height:"350"})},ue=function(e,t){return new Date(e,t+1,0).getDate()},ie=function(){var e=[];e.length=12;for(var t=new Date,n=t.getMonth(),a=t.getFullYear(),r=11;r>=0;r--){var c=new Date(a,n,1).toLocaleString("default",{month:"short"}),u=[];u.length=ue(a,n),u.fill(0),e[r]={data:u,name:c},0===n&&a--,n=(n+11)%12}return e},oe=function(e){var t=e.activities,n=(new Date).getFullYear(),a=(new Date).getMonth(),c=ie(),u=0;t.forEach(function(e){var t=new Date(e.date),r=t.getFullYear(),i=t.getMonth(),o=11-12*(n-r)-(a-i);if(o>=0){var l=t.getDate()-1;c[o].data[l]+=e.distance,u=Math.max(u,Math.ceil(c[o].data[l]))}});var i=c.map(function(e){return Object(ne.a)({},e,{data:e.data.map(function(e){return U(e)})})});return r.a.createElement(ce,{seriesData:i.reverse(),highestDistance:u})},le=n(84),se=n(45),fe=n(413);function de(){var e=Object(s.a)(["\n  margin-bottom: 1em;\n"]);return de=function(){return e},e}var me=m.a.div(de()),pe=function(e){var t=e.activityCount,n=e.totalDistance,a=e.totalTime,c=e.averageDistance,u=e.averagePace;return r.a.createElement("div",null,r.a.createElement(le.a,{gutter:16},r.a.createElement(se.a,{span:8},r.a.createElement(fe.a,{title:"Activities",value:t})),r.a.createElement(se.a,{span:8},r.a.createElement(fe.a,{title:"Distance",value:"".concat(n," km")})),r.a.createElement(se.a,{span:8},r.a.createElement(fe.a,{title:"Time",value:a}))),r.a.createElement(me,null),r.a.createElement(le.a,{gutter:16},r.a.createElement(se.a,{span:8}),r.a.createElement(se.a,{span:8},r.a.createElement(fe.a,{title:"Average Distance",value:"".concat(c," km")})),r.a.createElement(se.a,{span:8},r.a.createElement(fe.a,{title:"Average Pace",value:u}))))},ve=function(e){var t=e.activities,n=t.length,a=0,c=0;t.forEach(function(e){a+=e.distance,c+=e.time});var u=a/n,i=Math.round(c/a);return r.a.createElement(pe,{activityCount:n,totalDistance:U(a),totalTime:L(c),averageDistance:U(u),averagePace:L(i)})},ge=n(415);function he(){var e=Object(s.a)(["\n  margin-bottom: 1em;\n"]);return he=function(){return e},e}var Ee=Object(m.a)(ge.a)(he()),be=function(e,t){return r.a.createElement(Ee,{title:e,bordered:!1},t)};function Oe(){var e=Object(s.a)(["\n  margin: 0 auto;\n  max-width: 60em;\n"]);return Oe=function(){return e},e}function we(){var e=Object(s.a)(["\n  background-color: #F5F5FA;\n  min-height: 100vh;\n  padding-bottom: 1em;\n  width: 100%;\n"]);return we=function(){return e},e}var je=f.a.TabPane,ye=m.a.div(we()),xe=m.a.div(Oe()),De=Object(i.b)(function(e){return{activities:e.activities}})(function(e){var t=e.activities;return r.a.createElement(ye,null,r.a.createElement(te,null),r.a.createElement(xe,null,null===t?r.a.createElement("div",null,"Loading activities."):0===t.length?r.a.createElement(d.a,null):r.a.createElement(f.a,{defaultActiveKey:"1"},r.a.createElement(je,{tab:"Dashboard",key:"1"},be("Total Stats",r.a.createElement(ve,{activities:t})),be("Past 12 Months",r.a.createElement(oe,{activities:t})),be("Heatmap",r.a.createElement(b,{activities:t}))),r.a.createElement(je,{tab:"Activities",key:"2"},r.a.createElement(R,{activities:t})))))});function Ie(){var e=Object(s.a)(["\n  color: #0083f7;\n  font-size: 3em;\n  font-weight: bold;\n"]);return Ie=function(){return e},e}var ke=m.a.h1(Ie()),Se=function(){return r.a.createElement("div",null,r.a.createElement("h4",null,"Welcome to"),r.a.createElement(ke,null,"Data Runner"),r.a.createElement("p",null,"Upload your activity files to get interesting stats, heatmaps, and more!"),r.a.createElement("p",null,"Sign in or register to get started!"))},Te=n(412),Ae=n(14);function Ue(){var e=Object(s.a)(["\n  display: flex;\n  justify-content: space-between;\n"]);return Ue=function(){return e},e}function Le(){var e=Object(s.a)(["\n  margin-bottom: 1em;\n"]);return Le=function(){return e},e}var _e=m.a.div(Le()),Ce=m.a.div(Ue()),Me=Object(i.b)(null,{loginUser:function(e){return Q(e,!1)},registerUser:function(e){return Q(e,!0)}})(function(e){var t=Object(a.useState)(""),n=Object(G.a)(t,2),c=n[0],u=n[1],i=Object(a.useState)(""),o=Object(G.a)(i,2),l=o[0],s=o[1];return r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.loginUser({username:c,password:l})}},r.a.createElement(_e,null,r.a.createElement(Te.a,{placeholder:"Username",value:c,prefix:r.a.createElement(Ae.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),onChange:function(e){var t=e.target;return u(t.value)}})),r.a.createElement(_e,null,r.a.createElement(Te.a.Password,{placeholder:"Password",value:l,prefix:r.a.createElement(Ae.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),onChange:function(e){var t=e.target;return s(t.value)}})),r.a.createElement(Ce,null,r.a.createElement(F.a,{type:"primary",htmlType:"submit"},"Log in"),r.a.createElement(F.a,{onClick:function(t){t.preventDefault(),e.registerUser({username:c,password:l})}},"Register")))}),Ne=n(212),Re=n.n(Ne);function Fe(){var e=Object(s.a)(["\n  width: 40%;\n"]);return Fe=function(){return e},e}function Ge(){var e=Object(s.a)(["\n  background-image: url(",");\n  background-position: center center;\n  background-size: cover;\n  width: 60%;\n"]);return Ge=function(){return e},e}function Pe(){var e=Object(s.a)(["\n  align-items: center;\n  display: flex;\n  float: left;\n  height: 100vh;\n  justify-content: center;\n  @media (max-width: 768px) {\n    width: 100%;\n    height: 400px;\n  }\n"]);return Pe=function(){return e},e}function Ve(){var e=Object(s.a)(['\n  &:after {\n    content: "";\n    display: table;\n    clear: both;\n  }\n']);return Ve=function(){return e},e}var ze=m.a.div(Ve()),Ye=m.a.div(Pe()),Be=Object(m.a)(Ye)(Ge(),Re.a),Je=Object(m.a)(Ye)(Fe()),We=function(e){var t=e.handleLogin,n=e.handleRegister;return r.a.createElement(ze,null,r.a.createElement(Be,null,r.a.createElement(Se,null)),r.a.createElement(Je,null,r.a.createElement(Me,{handleLogin:t,handleRegister:n})))},He=n(205);function Ke(){var e=Object(s.a)(["\n  position: fixed;\n  top: 6.5em;\n  left: 2em;\n"]);return Ke=function(){return e},e}var qe=Object(m.a)(He.a)(Ke()),Qe=function(){return r.a.createElement(qe,null)},Xe=n(117),Ze=Object(i.b)(function(e){return{user:e.user}})(function(e){var t=e.render,n=e.user,a=Object(Xe.a)(e,["render","user"]);return r.a.createElement(l.b,Object.assign({},a,{render:n?t:function(){return r.a.createElement(l.a,{to:"/"})}}))}),$e=Object(i.b)(function(e){return{user:e.user}})(function(e){var t=e.render,n=e.user,a=Object(Xe.a)(e,["render","user"]);return r.a.createElement(l.b,Object.assign({},a,{render:n?function(){return r.a.createElement(l.a,{to:"/user"})}:t}))}),et=Object(i.b)(function(e){return{loading:e.loading}},{setUserAndGetData:q})(function(e){var t=e.loading,n=e.setUserAndGetData;return Object(a.useEffect)(function(){var e=Y();e&&n(e)},[n]),r.a.createElement(o.a,null,t&&r.a.createElement(Qe,null),r.a.createElement(l.d,null,r.a.createElement($e,{exact:!0,path:"/",render:function(){return r.a.createElement(We,null)}}),r.a.createElement(Ze,{exact:!0,path:"/user",render:function(){return r.a.createElement(De,null)}})))}),tt=n(59),nt=n(213),at=n(214),rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_ACTIVITIES":return t.data;case"NEW_ACTIVITIES":return e.concat(t.data);case"DELETE_ACTIVITY":return e.filter(function(e){return e.id!==t.data});default:return e}},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING":return t.data;default:return e}},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOGGED_IN_USER":return t.data;case"REMOVE_LOGGED_IN_USER":return null;default:return e}},it=Object(tt.combineReducers)({activities:rt,loading:ct,user:ut}),ot=Object(tt.createStore)(it,Object(at.composeWithDevTools)(Object(tt.applyMiddleware)(nt.a)));n(409);u.a.render(r.a.createElement(i.a,{store:ot},r.a.createElement(et,null)),document.getElementById("root"))}},[[220,1,2]]]);
//# sourceMappingURL=main.f3786913.chunk.js.map